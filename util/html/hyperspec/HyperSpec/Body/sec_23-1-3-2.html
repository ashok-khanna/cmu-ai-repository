<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!-- Common Lisp HyperSpec (TM), version 3.0 generated by kmp on Thu, 2-May-1996 10:21am EDT -->
<HTML>

<!-- Mirrored from www.cs.cmu.edu/afs/cs/project/ai-repository/ai/util/html/hyperspec/HyperSpec/Body/sec_23-1-3-2.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Oct 2021 10:18:31 GMT -->
<HEAD>
<TITLE>CLHS: Section 23.1.3.2</TITLE>
<META HTTP-EQUIV="Author" CONTENT="Kent M. Pitman">
<META HTTP-EQUIV="Organization" CONTENT="The Harlequin Group Limited">
<LINK REL=TOP HREF="../FrontMatter/index-2.html">
<LINK REL=COPYRIGHT HREF="../FrontMatter/About-HyperSpec.html#Legal">
<LINK REL=DISCLAIMER HREF="../FrontMatter/About-HyperSpec.html#Disclaimer">
<LINK REL=PREV HREF="sec_23-1-3-1.html">
<LINK REL=UP HREF="sec_23-1-3.html">
<LINK REL=NEXT HREF="sec_the_reader_dictionary.html">
</HEAD>
<BODY BGCOLOR="#c0c0c0">
<H1><A REV=MADE HREF="http://www.harlequin.com/"><IMG ALT="[HARLEQUIN]" SRC="../Graphics/Harlequin-Small.gif" ALIGN=Bottom></A><A REL=TOP HREF="../FrontMatter/index-2.html"><IMG ALT="[Common Lisp HyperSpec (TM)]" SRC="../Graphics/HyperSpec-Small.gif" ALIGN=Bottom></A> <A REL=PREV HREF="sec_23-1-3-1.html"><IMG ALT="[Previous]" SRC="../Graphics/Prev.gif" ALIGN=Bottom></A><A REL=UP HREF="sec_23-1-3.html"><IMG ALT="[Up]" SRC="../Graphics/Up.gif" ALIGN=Bottom></A><A REL=NEXT HREF="sec_the_reader_dictionary.html"><IMG ALT="[Next]" SRC="../Graphics/Next.gif" ALIGN=Bottom></A></H1>

<HR>

<H2>
23.1.3.2 The RECURSIVE-P argument</H2> <P>
If <I>recursive-p</I> is supplied and not <A REL=DEFINITION HREF="any_nil.html#nil"><B>nil</B></A>, it specifies that this function call is not an outermost call to <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read"><B>read</B></A> but an embedded call, typically from a <A REL=DEFINITION HREF="glo_r.html#reader_macro_function"><I>reader macro function</I></A>. It is important to distinguish such recursive calls for three reasons. <P>
<P><DL><DT>1.  An outermost call establishes the context within which the <TT>#</TT><I>n</I><TT>=</TT> and <TT>#</TT><I>n</I><TT>#</TT> syntax is scoped. Consider, for example, the expression <P><DD>
<PRE>
 (cons '#3=(p q r) '(x y . #3#))
</PRE>
</TT> If the <A REL=DEFINITION HREF="glo_s.html#single-quote"><I>single-quote</I></A> <A REL=DEFINITION HREF="glo_r.html#reader_macro"><I>reader macro</I></A> were defined in this way: <P>
<PRE>
 (set-macro-character #\'       ;incorrect
    #'(lambda (stream char)
         (declare (ignore char))
         (list 'quote (read stream))))
</PRE>
</TT> <P>
then each call to the <A REL=DEFINITION HREF="glo_s.html#single-quote"><I>single-quote</I></A> <A REL=DEFINITION HREF="glo_r.html#reader_macro_function"><I>reader macro function</I></A> would establish independent contexts for the scope of <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read"><B>read</B></A> information, including the scope of identifications between markers like ``<TT>#3=</TT>'' and ``<TT>#3#</TT>''. However, for this expression, the scope was clearly intended to be determined by the outer set of parentheses, so such a definition would be incorrect. The correct way to define the <A REL=DEFINITION HREF="glo_s.html#single-quote"><I>single-quote</I></A> <A REL=DEFINITION HREF="glo_r.html#reader_macro"><I>reader macro</I></A> uses <I>recursive-p</I>: <P>
<PRE>
 (set-macro-character #\'       ;correct
    #'(lambda (stream char)
         (declare (ignore char))
         (list 'quote (read stream t nil t))))
</PRE>
</TT> <P>
<DT>2.  A recursive call does not alter whether the reading process is to preserve <A REL=DEFINITION HREF="glo_w.html#whitespace"><I>whitespace</I></A>[2] or not (as determined by whether the outermost call was to <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read"><B>read</B></A> or <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read-preserving-whitespace"><B>read-preserving-whitespace</B></A>). Suppose again that <A REL=DEFINITION HREF="glo_s.html#single-quote"><I>single-quote</I></A> were to be defined as shown above in the incorrect definition. Then a call to <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read-preserving-whitespace"><B>read-preserving-whitespace</B></A> that read the expression <TT>'foo&lt;Space&gt;</TT> would fail to preserve the space character following the symbol <TT>foo</TT> because the <A REL=DEFINITION HREF="glo_s.html#single-quote"><I>single-quote</I></A> <A REL=DEFINITION HREF="glo_r.html#reader_macro_function"><I>reader macro function</I></A> calls <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read"><B>read</B></A>, not <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read-preserving-whitespace"><B>read-preserving-whitespace</B></A>, to read the following expression (in this case <TT>foo</TT>). The correct definition, which passes the value <A REL=DEFINITION HREF="glo_t.html#true"><I>true</I></A> for <I>recursive-p</I> to <A REL=DEFINITION HREF="fun_readcm_re_g-whitespace.html#read"><B>read</B></A>, allows the outermost call to determine whether <A REL=DEFINITION HREF="glo_w.html#whitespace"><I>whitespace</I></A>[2] is preserved. <P><DD>
<DT>3.  When end-of-file is encountered and the <I>eof-error-p</I> argument is not <A REL=DEFINITION HREF="any_nil.html#nil"><B>nil</B></A>, the kind of error that is signaled may depend on the value of <I>recursive-p</I>. If <I>recursive-p</I> is <A REL=DEFINITION HREF="glo_t.html#true"><I>true</I></A>, then the end-of-file is deemed to have occurred within the middle of a printed representation; if <I>recursive-p</I> is <A REL=DEFINITION HREF="glo_f.html#false"><I>false</I></A>, then the end-of-file may be deemed to have occurred between <A REL=DEFINITION HREF="glo_o.html#object"><I>objects</I></A> rather than within the middle of one. <P><DD>
<P></DL><P>

<HR>

<A REL=NAVIGATOR HREF="../FrontMatter/Starting-Points.html"><IMG ALT="[Starting Points]" SRC="../Graphics/Starting-Points.gif" ALIGN=Bottom></A><A REL=TOC HREF="../FrontMatter/Chapter-Index.html"><IMG ALT="[Contents]" SRC="../Graphics/Contents.gif" ALIGN=Bottom></A><A REL=INDEX HREF="../FrontMatter/Master-Index.html"><IMG ALT="[Index]" SRC="../Graphics/Index.gif" ALIGN=Bottom></A><A REL=INDEX HREF="../FrontMatter/Symbol-Index.html"><IMG ALT="[Symbols]" SRC="../Graphics/Symbols.gif" ALIGN=Bottom></A><A REL=GLOSSARY HREF="sec_26-1.html"><IMG ALT="[Glossary]" SRC="../Graphics/Glossary.gif" ALIGN=Bottom></A><A HREF="../Issues/Issues-Categorized.html"><IMG ALT="[Issues]" SRC="../Graphics/Issues.gif" ALIGN=Bottom></A><BR>

<A REL=COPYRIGHT HREF="../FrontMatter/About-HyperSpec.html#Legal"><I>Copyright 1996, The Harlequin Group Limited.  All Rights Reserved.</I></A><P>
</BODY>

<!-- Mirrored from www.cs.cmu.edu/afs/cs/project/ai-repository/ai/util/html/hyperspec/HyperSpec/Body/sec_23-1-3-2.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Oct 2021 10:18:31 GMT -->
</HTML>
