
%% August 10, 1993

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Style File for `Small Format Journals'                               %%
%% Kluwer Academic Publishers                                           %%
%%                                                                      %%
%% Prepared by Amy Hendrickson, TeXnology Inc.                          %%
%%                                                                      %%
%% Inquiries to Suzanne M. Rumsey, net address: prod@world.std.com      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{Document Style `Small Format Journals' 
for Kluwer Academic Publishers}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{Written by Amy Hendrickson, TeXnology, Inc.\space}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{Authors! Before beginning to work, please ftp the README file from}
\typeout{the directory /Kluwer/styles/journals at world.std.com}
\typeout{to see if you have the current version of this file!}
\typeout{This version is dated August 10, 1993}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{\space\space\space\space\space\space\space\space\space}


%% Special Purpose Fonts
\font\smallcaps=cmcsc10 scaled 700
\font\medcaps=cmcsc10 scaled 750 %
\def\bigbit{\Large\it}

\def\issuetocfont{\LARGE\bf}
\let\bit\sl
\let\sectionfont\bf
\let\subsubsectionfont\it

%%%%%%%
%% Variations on  LaTeX book.sty 


\def\@ptsize{0}               % Default is REP10.STY
\@namedef{ds@11pt}{\def\@ptsize{1}} % 11pt option reads in REP11.STY
\@namedef{ds@12pt}{\def\@ptsize{2}} % 12pt option reads in REP12.STY


\@twosidetrue     %  Defines twoside option.
\@mparswitchtrue  %  Marginpars go on outside of page.

\def\ds@draft{\overfullrule 5pt}  % Causes overfull hboxes to be marked.

\@options

%%%%%% Start Bk10.sty
% bk10.sty 19-Jan-88

\lineskip 1pt \normallineskip 1pt
\def\baselinestretch{1}

\def\@normalsize{\@setsize\normalsize{12pt}\xpt\@xpt
\abovedisplayskip 10pt plus2pt minus5pt\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus3pt\belowdisplayshortskip 6pt plus3pt
minus3pt\let\@listi\@listI} 
\def\small{\@setsize\small{11pt}\ixpt\@ixpt
\abovedisplayskip 8.5pt plus 3pt minus 4pt\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus2pt\belowdisplayshortskip 4pt plus2pt minus 2pt
\def\@listi{\leftmargin\leftmargini \topsep 4pt plus 2pt minus 2pt\parsep 2pt
plus 1pt minus 1pt
\itemsep \parsep}}

\def\footnotesize{\@setsize\footnotesize{9.5pt}\viiipt\@viiipt
\abovedisplayskip 6pt plus 2pt minus 4pt\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus 1pt\belowdisplayshortskip 3pt plus 1pt minus
2pt
\def\@listi{\leftmargin\leftmargini \topsep 3pt plus 1pt minus 1pt\parsep 2pt
plus 1pt minus 1pt
\itemsep \parsep}}
\def\scriptsize{\@setsize\scriptsize{8pt}\viipt\@viipt}
\def\tiny{\@setsize\tiny{6pt}\vpt\@vpt}
\def\large{\@setsize\large{14pt}\xiipt\@xiipt}
\def\Large{\@setsize\Large{18pt}\xivpt\@xivpt}
\def\LARGE{\@setsize\LARGE{22pt}\xviipt\@xviipt}
\def\huge{\@setsize\huge{25pt}\xxpt\@xxpt}
\def\Huge{\@setsize\Huge{30pt}\xxvpt\@xxvpt}
\normalsize 

\oddsidemargin 1in \evensidemargin 1in 
\marginparwidth .75in \marginparsep 7pt 
 \topmargin .75in \headheight 12pt \headsep 24pt \footskip .35in 

\raggedbottom
\textheight = 44.5pc
\textwidth 30pc 

\columnsep 10pt \columnseprule 0pt 

\footnotesep 6.65pt 
\skip\footins 9pt plus 4pt minus 2pt 
\floatsep 12pt plus 2pt minus 2pt \textfloatsep 20pt plus 2pt minus 4pt
\intextsep 12pt plus 2pt minus 2pt \@maxsep 20pt \dblfloatsep 12pt plus 2pt
minus 2pt \dbltextfloatsep 20pt plus 2pt minus 4pt \@dblmaxsep 20pt 
\@fptop 0pt plus 1fil \@fpsep 8pt plus 2fil \@fpbot 0pt plus 1fil 
\@dblfptop 0pt plus 1fil \@dblfpsep 8pt plus 2fil \@dblfpbot 0pt plus 1fil
\marginparpush 5pt 

\parskip 0pt plus 1pt \parindent 8pt \partopsep 2pt plus 1pt minus 1pt 
\@lowpenalty 51 \@medpenalty 151 \@highpenalty 301 
\@beginparpenalty -\@lowpenalty \@endparpenalty -\@lowpenalty \@itempenalty
-\@lowpenalty 

\clubpenalty=10000
\widowpenalty=10000



%% Article commands:

\def\authorrunninghead#1{\def\theauthors{\uppercase{#1}}}
\def\titlerunninghead#1{\def\thetitle{\uppercase{#1}}}

\def\thetitle{THE TITLE???}
\def\theauthors{}

\newif\iftechnote
\def\technicalnote{\global\technotetrue}


\newif\iftitle
\def\title#1{\global\appendonfalse
\refstepcounter{chapter}
\c@section=0
\c@subsection=0
\c@subsubsection=0
\c@footnote=0
\c@equation=0
\c@figure=0
\c@table=0
\vspace*{24pt}
\iftechnote\global\technotefalse
\noindent {\bigbit Technical Note}\vskip4pt\fi
\global\titletrue
{\def\\ {\hfill\break}%
\Large\raggedright\hyphenpenalty=10000\noindent\bf#1\vskip12pt}}
\let\articletitle\title


\def\xemail{\email}

\long\def\author#1#2{\def\two{#2}\ifx\two\xemail\long\def\go{\emailauthor{#1}}
\else\long\def\go{\noemailauthor{#1}#2}\fi\go}

\def\emailauthor#1#2{\ifdim\lastskip=4pt \vskip-6pt\fi\setbox0=\hbox{%
\smallcaps\uppercase{#1}\qquad\smallcaps\lowercase{#2}}
\ifdim\wd0<30pc
\hbox to30pc{\smallcaps\uppercase{#1}\hfill
\smallcaps\lowercase{#2}}
\else
\noindent{\smallcaps\uppercase{#1}}
\vskip4pt
\setbox1=\hbox{\smallcaps\lowercase{#2}}
\ifdim\wd1>30pc\message{EMAIL ADDRESS TOO WIDE! PLEASE LIST
SEPARATELY!}
! EMAIL ADDRESS TOO WIDE! PLEASE LIST SEPARATELY !

#2
\else\hbox to30pc{\hfill\smallcaps\lowercase{#2}}\fi\fi
\vskip4pt}

\def\noemailauthor#1{\noindent{\smallcaps\uppercase{#1}}
\vskip4pt}


\let\authors\author

\def\affil#1{\vskip-4pt{\def\\ {\hfill\break}
\footnotesize\it\noindent#1\vskip8pt}}

\def\editor#1{\vskip4pt
{\footnotesize\noindent{\bf Editor:} #1\vskip1sp}}

\def\abstract#1{\vskip14pt
{\footnotesize\noindent{\bf Abstract.} #1\vskip1sp}}

\def\keywords#1{\vskip8pt
{\footnotesize\noindent{\bf Keywords:} #1\vskip1sp}}


\def\issuenumber#1{\def\currissuenumber{#1}}
\def\issuemonth#1{\def\currissuemonth{#1}}
\def\volnumber#1{\def\currvolnumber{#1}}
\def\volyear#1{\def\currvolyear{#1}}
\def\journame#1{\def\thisjourname{#1}}

\volnumber{[Volumn Number]}
\volyear{[Volumn Year]}
\issuenumber{[Issue Number]}
\issuemonth{[Issue Year]}
\journame{[Journal Name]}

\newcount\articlenumber

\def\article{\clearpage
\ifodd\c@page\else\null\clearpage\fi
}

\def\endarticle{\write\@auxout{\string\expandafter
\string\gdef\string\csname\space 
endpage\the\articlenumber\endcsname{\the\c@page}}
\newpage
\authorrunninghead{}
}

\def\kluwerline{\global\advance\articlenumber by1
\hbox to30pc{\hfill\egtrm \thisjourname,
\currvolnumber, \the\c@page--%
\expandafter\ifx\csname endpage\the\articlenumber\endcsname\relax%
??\else\csname endpage\the\articlenumber\endcsname\fi\ (\currvolyear)}
\vskip2pt
\hbox to30pc{\hfill\egtrm \raise1.5pt\hbox{\scriptsize\copyright}%
\ \currvolyear\ %
Kluwer Academic Publishers, Boston. Manufactured in The Netherlands.}
\vskip3pt
}

\newcount\footnum
\newcount\savefootnum
\def\notes{\ifnum\footnum=0\else
\section*{Notes}
\savefootnum=\footnum
\footnum=0
\noindent\loop\ifnum\savefootnum>\footnum
\global\advance\footnum by1
\csname foot\the\footnum\endcsname
\expandafter\gdef\csname foot\the\footnum\endcsname{\relax}
\repeat\global\footnum=0\relax\fi}


\def\footnote#1{\global\advance\footnum by 1\relax$^{\the\footnum}$%
\long\expandafter\gdef\csname foot\the\footnum\endcsname{%
\vtop{\footnotesize\hsize=30pc\leftskip=12pt\relax\parindent=-12pt
\indent\hbox to12pt{\hfill\the\footnum. }{#1\strut\vskip1sp}}\vskip1pt}}

%% End Matter
\def\acknowledgements{\goodbreak\section*{Acknowledgements}}

\def\thebibliography#1{\notes\section*{References}%
\bgroup\footnotesize\labelsep=6pt
\list{[\arabic{enumi}]}{\settowidth\labelwidth{[#1]}\leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \usecounter{enumi}}
    \def\newblock{\hskip .11em plus .33em minus .07em}
    \sloppy\clubpenalty4000\widowpenalty4000
    \sfcode`\.=1000\relax}

\def\endthebibliography{\endlist\egroup\vskip\baselineskip\relax}

\def\references{\goodbreak\section*{References}
\bgroup\footnotesize\labelsep=6pt
\list{[\arabic{enumi}]}{\settowidth\labelwidth{[99]}\leftmargin\labelwidth
 \advance\leftmargin\labelsep
 \usecounter{enumi}}
 \def\newblock{\hskip .11em plus .33em minus .07em}
 \sloppy\clubpenalty4000\widowpenalty4000
 \sfcode`\.=1000\relax\frenchspacing}

\def\endreferences{\endlist\egroup\vskip\baselineskip\relax}

%% Alphabetical References
\def\alphareferences{\notes\goodbreak
\section*{References}
\bgroup\let\bibitem\alphabibitem\footnotesize \leftskip=6pt
\parindent=-6pt \indent\hskip-6pt\relax\ignorespaces}
\def\endalphareferences{\vskip1sp\egroup}

\def\alphabibitem{\@ifnextchar[{\alpha@lbibitem}{\alpha@bibitem}}

\def\alpha@lbibitem[#1]#2{\vskip1sp%\item[\@biblabel{#1}]
\if@filesw 
      { \def\protect##1{\string ##1\space}\immediate
        \write\@auxout{\string\bibcite{#2}{#1}}}\fi\ignorespaces}
%% Placement of `}' in def of \@lbibitem corrected 29 Apr 87
%% (Error found by Arthur Ogawa.)

\def\alpha@bibitem#1{\vskip1sp%\item
\if@filesw \immediate\write\@auxout
       {\string\bibcite{#1}{#1}}\fi\ignorespaces}


\newif\ifappendon

\def\appendix{\goodbreak
\global\appendontrue
\c@section=0
\c@subsection=0
\c@subsubsection=0
\c@equation=0
\c@figure=0
\c@table=0
\section*{Appendix}}

% \@startsection {NAME}{LEVEL}{INDENT}{BEFORESKIP}{AFTERSKIP}{STYLE} 
%            optional * [ALTHEADING]{HEADING}
%    Generic command to start a section.  
%    NAME       : e.g., 'subsection'
%    LEVEL      : a number, denoting depth of section -- e.g., chapter=1,
%                 section = 2, etc.  A section number will be printed if
%                 and only if LEVEL < or = the value of the secnumdepth
%                 counter.
%    INDENT     : Indentation of heading from left margin
%    BEFORESKIP : Absolute value = skip to leave above the heading.  
%                 If negative, then paragraph indent of text following 
%                 heading is suppressed.
%    AFTERSKIP  : if positive, then skip to leave below heading,
%                       else - skip to leave to right of run-in heading.
%    STYLE      : commands to set style
%  If '*' missing, then increments the counter.  If it is present, then
%  there should be no [ALTHEADING] argument.  A sectioning command
%  is normally defined to \@startsection + its first six arguments.

\def\section{\@startsection {section}{1}{\z@}{-20pt plus -2pt minus 
 -1pt}{12pt plus 1pt}{\normalsize\sectionfont}}
\def\subsection{\@startsection{subsection}{2}{\z@}{-20pt plus -2pt
minus -1pt}{12pt plus 1pt}{\normalsize\bit}}
\def\subsubsection{\@startsection{subsubsection}{3}{\z@}{-20pt
plus -2pt minus -1pt}{12pt plus1pt}{\normalsize\subsubsectionfont}}


\setcounter{secnumdepth}{3}

\leftmargini 16pt %24pt
\leftmarginii 18pt % 22pt 
\leftmarginiii 18pt %18.7pt 
\leftmarginiv 16pt %
\leftmarginv 10pt
\leftmarginvi 10pt
\leftmargin\leftmargini
\labelsep 6pt

\labelwidth\leftmargini\advance\labelwidth-\labelsep
\def\@listI{\leftmargin\leftmargini \parsep 4pt plus 2pt minus 1pt\topsep 8pt
plus 2pt minus 4pt\itemsep 4pt plus 2pt minus 1pt}
\let\@listi\@listI
\@listi 
\def\@listii{\leftmargin\leftmarginii
 \labelwidth\leftmarginii\advance\labelwidth-\labelsep
 \topsep 4pt plus 2pt minus 1pt
 \parsep 2pt plus 1pt minus 1pt
 \itemsep \parsep}
\def\@listiii{\leftmargin\leftmarginiii
 \labelwidth\leftmarginiii\advance\labelwidth-\labelsep
 \topsep 2pt plus 1pt minus 1pt 
 \parsep \z@ \partopsep 1pt plus 0pt minus 1pt
 \itemsep \topsep}
\def\@listiv{\leftmargin\leftmarginiv
 \labelwidth\leftmarginiv\advance\labelwidth-\labelsep}
\def\@listv{\leftmargin\leftmarginv
 \labelwidth\leftmarginv\advance\labelwidth-\labelsep}
\def\@listvi{\leftmargin\leftmarginvi
 \labelwidth\leftmarginvi\advance\labelwidth-\labelsep}

%%%%% End of Bk10.sty

\def\labelenumi{\theenumi.}    
\def\theenumi{\arabic{enumi}}     
 
\def\labelenumii{(\theenumii)}
\def\theenumii{\Alph{enumii}}
\def\p@enumii{\theenumi}

\def\labelenumiii{\theenumiii.}
\def\theenumiii{\hskip5pt\hbox to5pt{\hss\roman{enumiii}}}
\def\p@enumiii{\theenumi(\theenumii)}

\def\labelenumiv{\theenumiv.}
\def\theenumiv{\Alph{enumiv}}     
\def\p@enumiv{\p@enumiii\theenumiii}

\def\labelitemi{$\bullet$}
\def\labelitemii{\bf --}
\def\labelitemiii{$\ast$}
\def\labelitemiv{$\cdot$}

\def\verse{\let\\=\@centercr  
  \list{}{\itemsep\z@ \itemindent -1.5em\listparindent \itemindent 
          \rightmargin\leftmargin\advance\leftmargin 1.5em}\item[]}
\let\endverse\endlist

\def\quotation{\list{}{\listparindent 1.5em
    \itemindent\listparindent
    \rightmargin\leftmargin\parsep 0pt plus 1pt}\item[]}
\let\endquotation=\endlist

\def\quote{\list{}{\rightmargin\leftmargin}\item[]}
\let\endquote=\endlist

\def\descriptionlabel#1{\hspace\labelsep \bf #1}
\def\description{\list{}{\labelwidth\z@ \itemindent-\leftmargin
       \let\makelabel\descriptionlabel}}

\let\enddescription\endlist

\newdimen\descriptionmargin
\descriptionmargin=3em

\arraycolsep 5pt   % Half the space between columns in an array environment.
\tabcolsep 6pt     % Half the space between columns in a tabular environment.
\arrayrulewidth .4pt % Width of rules in array and tabular environment.
\doublerulesep 2pt   % Space between adjacent rules in array or tabular env.

\tabbingsep \labelsep   % Space used by the \' command.  (See LaTeX manual.)

\skip\@mpfootins = \skip\footins

\fboxsep = 3pt    % Space left between box and text by \fbox and \framebox.
\fboxrule = .4pt  % Width of rules in box made by \fbox and \framebox.

\newcounter{part}
\newcounter {chapter}
\newcounter {section}[chapter]
\newcounter {subsection}[section]
\newcounter {subsubsection}[subsection]

\def\@sect#1#2#3#4#5#6[#7]#8{\ifnum #2>\c@secnumdepth
     \def\@svsec{}\else 
     \refstepcounter{#1}\edef\@svsec{\csname the#1\endcsname.%<=== new, 7/1/93
\hskip 1em }\fi
     \@tempskipa #5\relax
      \ifdim \@tempskipa>\z@ 
        \begingroup #6\relax
          \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M #8\par}%
        \endgroup
       \csname #1mark\endcsname{#7}\addcontentsline
         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                      \protect\numberline{\csname the#1\endcsname}\fi
                    #7}\else
        \def\@svsechd{#6\hskip #3\@svsec #8\csname #1mark\endcsname
                      {#7}\addcontentsline
                           {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                             \protect\numberline{\csname the#1\endcsname}\fi
                       #7}}\fi
     \@xsect{#5}}


\def\thepart          {\Roman{part}}
\def\thechapter       {}
\def\thesection       {\ifappendon A.\fi\arabic{section}}
\def\thesubsection    {\thesection.\arabic{subsection}}
\def\thesubsubsection {\thesubsection.\arabic{subsubsection}}

\def\@pnumwidth{1.55em}
\def\@tocrmarg {2.55em}
\def\@dotsep{4.5}
\setcounter{tocdepth}{2}


\long\def\@makefntext#1{\parindent 1em\noindent 
            \hbox to 1.8em{\hss$^{\@thefnmark}$}#1}

%  \c@topnumber            : Number of floats allowed at the top of a column.
%  \topfraction            : Fraction of column that can be devoted to floats.
%  \c@dbltopnumber, \dbltopfraction : Same as above, but for double-column
%                          floats.
%  \c@bottomnumber, \bottomfraction : Same as above for bottom of page.
%  \c@totalnumber          : Number of floats allowed in a single column, 
%                          including in-text floats.
%  \textfraction         : Minimum fraction of column that must contain text.
%  \floatpagefraction    : Minimum fraction of page that must be taken
%                          up by float page.

%% June 10, 1993, reset these to more generous values to make it easier
%% to position floats.

\setcounter{topnumber}{3}
\setcounter{bottomnumber}{3}

\def\topfraction{.99}
\def\bottomfraction{.9}
\def\textfraction{.01}
\def\floatpagefraction{.5}

\setcounter{totalnumber}{9}

\setcounter{dbltopnumber}{2}
\def\dbltopfraction{.7}
\def\dblfloatpagefraction{.5}

\newcounter{figure}[chapter]
\def\thefigure{\@arabic\c@figure}

\def\fps@figure{tbp}
\def\ftype@figure{1}
\def\ext@figure{lof}
\def\fnum@figure{Figure\ \ifappendon A\fi\thefigure\theletter}
\def\figure{\@float{figure}}
\let\endfigure\end@float
\def\endfigure{\end@float\gdef\@currentlabel{}}
\@namedef{figure*}{\@dblfloat{figure}}
\@namedef{endfigure*}{\end@dblfloat}

\newcounter{table}[chapter]
\def\thetable{\@arabic\c@table}

\def\fps@table{tbp}
\def\ftype@table{2}
\def\ext@table{lot}
\def\fnum@table{Table \ifappendon A\fi\thetable\theletter}
\def\table{\footnotesize\@float{table}}
\let\endtable\end@float
\@namedef{table*}{\@dblfloat{table}}
\@namedef{endtable*}{\end@dblfloat}

\mark{{}{}}   % Initializes TeX's marks

\def\ps@headings{\def\@oddfoot{}\def\@evenfoot{}%       No feet.
\def\@evenhead{{\elvrm\thepage}\hfil\medcaps\theauthors}% 
                                                %       Left heading.
\def\@oddhead{\hbox{}\iftitle\global\titlefalse
\vbox to0pt{\vss\kluwerline}\else
{\medcaps\thetitle}\hfil{\elvrm\thepage}\fi}% Right heading.
}

\@addtoreset{equation}{chapter}   % Makes \chapter reset 'equation' counter.



\newif\ifqedequation
\def\theequation{\ifappendon A.\fi\arabic{equation}%
\ifinmathqed\global\inmathqedfalse\global\qedequationtrue\fi}

\ps@headings                % `headings' page style
\pagenumbering{arabic}      % Arabic page numbers
\onecolumn                  % Single-column.

%%%%%%%%%%%%
%%% Math

\def\themathletter{\relax}

\def\mathletter#1{\gdef\themathletter{#1}}
\def\spletter#1{\gdef\thespletter{#1}}
\spletter{}

%% Use: 
% \begin{equation} or \[  
% \begin{splitmath} top line\\ 
%                 bottom line
% \end{splitmath}
% \end{equation} or \]  

\def\splitmath#1\\{\hbox to-\mathindent{}\vcenter\bgroup%
\ifequation\advance\hsize by-24pt\relax\fi
\hbox to\hsize{%
$\displaystyle #1$\hss}\vskip2pt
\global\setbox0=\hbox\bgroup$\displaystyle}

\def\endsplitmath{$\egroup\hbox to\hsize{\hss\unhbox0}\egroup}

\newif\ifinmathqed
\newif\ifqedequation

\def\theequation{\thespletter\ifappendon A.\fi\arabic{equation}\themathletter}

%%% Variation on Fleqn.sty
% fleqn.sty 24-May-89

\linewidth=30pc

\def\[{\relax\ifmmode\@badmath\else\bgroup\@beginparpenalty\predisplaypenalty
 \@endparpenalty\postdisplaypenalty
 \begin{trivlist}
\vskip\abovedisplayskip
\item[]\leavevmode
 \hbox to\linewidth\bgroup$ \displaystyle
 \hskip\mathindent\bgroup\fi}

\def\]{\relax\ifmmode \egroup $\hfil%
\ifinmathqed\vrule height 6pt width6pt depth0pt\relax\fi%
\egroup 
\ifinmathqed\else\vskip\belowdisplayskip\fi
\end{trivlist}
\egroup\else
\@badmath \fi\spletter{}\mathletter{}}

\def\xrelax{\relax}


\newif\iffirsttime
\global\firsttimetrue
\newif\ifequation
\def\equation{\global\equationtrue\@beginparpenalty\predisplaypenalty%
\@endparpenalty\postdisplaypenalty%
\trivlist%
\vskip\abovedisplayskip%
\item[]\leavevmode%
\setbox0=\hbox\bgroup $ \displaystyle%
\hskip\mathindent}

\def\endequation{$\egroup%
\ifx\themathletter\xrelax\global\firsttimetrue%
\refstepcounter{equation}\else%
\iffirsttime\global\firsttimefalse\refstepcounter{equation}\fi\fi%
\setbox1=\hbox{\copy0\@eqnnum}%
\ifdim\wd1>\linewidth%
\vbox{\unskip\noindent\hbox to\linewidth{\unhbox0\hss}\vskip3pt%
\noindent\hbox to\linewidth{\hfill\displaywidth\linewidth\llap{\@eqnnum}}}%
\else%
\vbox{\unskip\noindent\hbox to\linewidth{%
\unhbox0\hfil\displaywidth\linewidth\llap{\@eqnnum}}}%
\fi%
\gdef\themathletter{\relax}\spletter{}%
\ifinmathqed\global\inmathqedfalse\global\qedequationtrue\fi%
\vskip\belowdisplayskip%
\endtrivlist\def\themathletter{\relax}\global\equationfalse}

\def\@@eqncr{\let\@tempa\relax 
    \ifcase\@eqcnt \def\@tempa{& & &}\or \def\@tempa{& &} 
      \else \def\@tempa{&}\fi 
     \@tempa 
\ifx\themathletter\xrelax
%% Aug. 9 bug fix ==>
\if@eqnsw
\stepcounter{equation}\fi
%% <==
\else\iffirsttime\global\firsttimefalse\stepcounter{equation}
\fi\fi
\if@eqnsw\@eqnnum
\fi\global\@eqnswtrue\global\@eqcnt\z@\cr}



\def\eqnarray{\let\@currentlabel=\theequation
\global\@eqnswtrue
\global\@eqcnt\z@\tabskip\mathindent\let\\=\@eqncr
\abovedisplayskip\topsep\ifvmode\advance\abovedisplayskip\partopsep\fi
\belowdisplayskip\abovedisplayskip
\belowdisplayshortskip\abovedisplayskip
\abovedisplayshortskip\abovedisplayskip
$$\everycr={\noalign{\gdef\themathletter{\relax}}}
\halign to
\linewidth\bgroup\@eqnsel\hskip\@centering$\displaystyle\tabskip\z@
 {##}$&\global\@eqcnt\@ne 
\hskip 2\arraycolsep \hfil${##}$\hfil
 &\global\@eqcnt\tw@ 
\hskip 2\arraycolsep $\displaystyle{##}$\hfil 
 \tabskip\@centering&\llap{##}\tabskip\z@\cr}

\def\endeqnarray{\@@eqncr\egroup
\global\firsttimetrue\spletter{}
$$\global\@ignoretrue }

\newdimen\mathindent 
\mathindent = 24pt

\def\wideequation{\bgroup\mathindent=0pt}
\def\endwideequation{\egroup\mathindent=24pt}

%%% End Math

%%% Captions

\def\theletter{\relax}
\newif\ifxfirsttime
\xfirsttimetrue

\def\caption{\ifx\@captype\xtable\else
\ifx\theletter\xrelax
\global\xfirsttimetrue\refstepcounter\@captype\else
\ifxfirsttime\global\xfirsttimefalse\refstepcounter\@captype\fi\fi
\fi
\edef\@currentlabel{\expandafter\csname p@\@captype\endcsname%
\expandafter\csname the\@captype\endcsname\theletter}
\xdef\currcaptype{\@captype}
\@dblarg{\@caption\@captype}}


\def\letteredcaption#1{\gdef\theletter{#1}\caption}

\long\def\@makecaption#1#2{%
 \ifx\@captype\xtable
\vskip1pt\else\vskip18pt\fi
%
\noindent\footnotesize{\it #1.} #2\par     %   THEN set as ordinary paragraph.
%
\xdef\@currentlabel{\expandafter\csname p@\@captype\endcsname%
\expandafter\csname the\@captype\endcsname\theletter}
%
\gdef\theletter{\relax}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Table Macros


\long\def\@caption#1[#2]#3{\par
\begingroup
    \@parboxrestore
    \normalsize
    \@makecaption{\csname fnum@#1\endcsname}{\ignorespaces #3}\par
  \endgroup}

\def\catchlabel{}
\let\savelabel\label

\def\table{\def\label##1{\gdef\catchlabel{##1}}%
\def\caption##1{\gdef\catchcaption{##1}}%
\footnotesize\@float{table}}

\let\saveendtable\endtable

\def\endtable{\ifx\catchlabel\empty\else
\savelabel{\catchlabel}\fi%
\gdef\@currentlabel{}%
\gdef\catchlabel{}\saveendtable}

\let\savecaption\caption
\newbox\savecurrtable
\let\savetabular\tabular
\let\saveendtabular\endtabular

\def\tabular{\global\setbox\savecurrtable\hbox\bgroup\savetabular}

\def\endtabular{\saveendtabular\egroup
\ifx\theletter\xrelax
\global\xfirsttimetrue\refstepcounter\@captype\else
\ifxfirsttime\global\xfirsttimefalse\refstepcounter\@captype\fi\fi
\hbox to30pc{\hss\vtop{\hsize=\wd\savecurrtable
\ifx\catchcaption\empty\else\savecaption{\catchcaption
\xdef\@currentlabel{\thetable\theletter}}\fi
\vskip1pt
\unhbox\savecurrtable}\hss}
\gdef\catchcaption{}}

%% for \begin{tabular*}...\end{tabular*}
\expandafter \let \csname endtabular*\endcsname = \endtabular
\expandafter \def\csname tabular*\endcsname #1{%
\global\setbox\savecurrtable\hbox\bgroup\def\@halignto{to #1}\@tabular}

\def\xtable{table}


\def\@array[#1]#2{\setbox\@arstrutbox=\hbox{\vrule 
     height\arraystretch \ht\strutbox
     depth\arraystretch \dp\strutbox
     width\z@}\@mkpream{#2}\edef\@preamble{\halign \noexpand\@halignto
\bgroup%
\tabskip\z@\@arstrut\@preamble
\ifx\@captype\xtable\hskip-\tabcolsep\fi%% <==== Changed
\tabskip\z@ \cr}%
\let\@startpbox\@@startpbox \let\@endpbox\@@endpbox%
  \if #1t\vtop \else \if#1b\vbox \else \vcenter \fi\fi%
  \bgroup\let\par\relax%
  \let\@sharp##\let\protect\relax \lineskip\z@\baselineskip\z@\@preamble}

%% new
\def\new@tabacol{\edef\@preamble{\@preamble\hskip0pt}}

\def\@tabclassz{\ifcase \@lastchclass\@acolampacol% 
\or \@ampacol \or
   \or \or \@addamp \or \@acolampacol\or \@firstampfalse 
\ifx\@captype\xtable \new@tabacol\else\@tabacol \fi%
\fi%
\edef\@preamble{\@preamble%
  \ifcase \@chnum%
     \hfil\ignorespaces\@sharp\unskip\hfil%
     \or \ignorespaces\@sharp\unskip\hfil%
     \or \hfil\hskip\z@ \ignorespaces\@sharp\unskip\fi}}

\let\savehline\hline
\def\hline{\noalign{\vskip3pt}\savehline\noalign{\vskip3pt}}


%% Listing

\def\enumerate{\ifnum \@enumdepth >3 \@toodeep\else
      \advance\@enumdepth \@ne 
      \edef\@enumctr{enum\romannumeral\the\@enumdepth}\list
      {\csname label\@enumctr\endcsname}{\usecounter
        {\@enumctr}\def\makelabel##1{##1\hss}}\fi}

\def\itemize{\ifnum \@itemdepth >3 \@toodeep\else \advance\@itemdepth \@ne
\edef\@itemitem{labelitem\romannumeral\the\@itemdepth}%
\list{\csname\@itemitem\endcsname}%{\def\makelabel##1{\hss\llap{##1}}}\fi}
{\def\makelabel##1{##1\hss}}\fi}


\def\@trivlist{\ifnum\@itemdepth>1 \vskip-\topsep\fi
\@topsepadd\topsep
  \if@noskipsec \leavevmode \fi
  \ifvmode \advance\@topsepadd\partopsep \else \unskip\par\fi
  \if@inlabel \@noparitemtrue \@noparlisttrue 
    \else \@noparlistfalse \@topsep\@topsepadd \fi
    \advance\@topsep \parskip
  \leftskip\z@
%\advance \leftskip1pc % <<<<<<<<<
\rightskip\@rightskip \parfillskip\@flushglue
  \@setpar{\if@newlist\else{\@@par}\fi}%
  \global\@newlisttrue \@outerparskip\parskip}

%%%%%%%%%%% Code examples in text

%% Algorithm

\newcount\algocount
\def\looker{\ifx\next\end\else\ifx\next\lineending\vskip-4pt%
\noindent\qquad\else\global\advance\algocount by1\relax%
\vskip0pt\noindent\hskip12pt\hbox to0pt{\hss\the\algocount.}\quad\fi\fi}

\def\lineending{\parfillskip=0pt plus1fil\relax\futurelet\next\looker}

{\obeylines
\gdef\algorithm{\medskip\let\bit\bf
\def\note##1{\parfillskip=0pt\hfill##1}\def\ {\qquad}%
\baselineskip=12pt\parskip=2pt\obeylines\let^^M=\lineending}}

\def\endalgorithm{\vskip1pt}

%% Theorems, Proofs, Examples, etc.

\def\@endtheorem{\if@newlist\@noitemerr\fi 
   \if@inlabel\indent\fi 
   \ifhmode\unskip \par\fi 
\vskip6pt}

\def\@thmcountersep{}



\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{claim}{Claim}[chapter]

\def\demo#1{\vskip12pt
\noindent{\it#1.\/} }
\def\enddemo{\vskip12pt}

\def\example{\vskip12pt
\noindent{\it Example:\/} }
\def\endexample{\qed
\vskip12pt}

\def\inmathqed{\global\inmathqedtrue}

\def\qed{\penalty-250%
\hbox to 6pt{\hfill}\hfill\llap{%
\vbox{\hrule\hbox{\vrule height6pt\hskip6pt\vrule}\hrule}}}


\def\slug{\penalty-250%
\hbox to 6pt{\hfill}\hfill\llap{\vrule height 6pt width 6pt depth0pt}}

\def\proof{\futurelet\next\lookforbracket}

\def\lookforbracket{\ifx\next[\let\go\usespecialterm
\else\let\go\relax
\vskip1sp\noindent{\bf Proof:}\enskip\relax\ignorespaces\fi\go}

\def\usespecialterm[#1]{\vskip12pt
\noindent{\bf #1:}\enskip\relax\ignorespaces}

\def\endproof{\ifqedequation\vskip-6pt%
\vskip-\belowdisplayskip\hfill\slug\else%
\ifinmathqed\global\inmathqedfalse\else\slug\fi\fi\vskip12pt}

\def\proclaim#1{\vskip12pt\bgroup\noindent{\bf#1}\enskip\it\ignorespaces}
\def\endproclaim{\egroup\vskip6pt}

%%% Macros for Kluwer: Issue and Volume Table of Contents

\def\volumetocline{\hbox to30pc{\hss\Large\bf Table of Contents:
Volume \currvolnumber\ (\currvolyear)\hss}}

\def\volumetoc{\clearpage\thispagestyle{empty}\bgroup
\hyphenpenalty=10000
\let\TOCarticle\volTOCarticle
\def\\ {\hfill\break}
\volumetocline}

\def\endvolumetoc{\egroup\newpage}

\def\tocnumberline#1{\vskip26pt
{\elvbf\noindent#1}\vskip8pt}

\def\TOCvolumeline#1{\noindent{\large#1}\vskip24pt
\hrule width 30pc}

%% Changed to accept titles more than 2 lines long


\def\volTOCarticle#1#2#3{\vskip.5pt
\setbox0=\hbox{#1\hskip12pt{\it#2}}
\ifdim\wd0<27pc
   %% The simple case, it will fit on one line:
  \hbox to30pc{\strut#1\dotfill{\it#2}\hbox to36pt{\hss#3}}
\else
   %% Find out what we must do next:
   \setbox1=\hbox{#1} \setbox2=\hbox{\hskip18pt{\it #2}}
   \dimen3=\wd1
   \advance\dimen3 by \wd2
   %% Is it 2 lines long?
  \ifdim\dimen3<56pc
   %% Yes, it is 2 lines long.
   %% Is title more than one line long?
       \ifdim\wd1>28pc
   %% Title is more than 1 line long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=36pt
   #1% 
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 1 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=36pt
   #1\dotfill\break\hbox to27pc{\dotfill\strut\hbox{{\it#2}\hbox 
   to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \else
   %% It is more than 2 lines long!
   %% Is title more than two lines long?
       \ifdim\wd1>56pc
   %% Title is more than 2 lines long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=36pt
   #1%
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 2 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=36pt
   #1\dotfill\break
      \hbox to27pc{\dotfill\strut\hbox{{\it#2}\hbox 
      to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \fi
\fi
\vskip.5pt
}

%% Changed to cover possibility of title 2 or more lines long.

\def\TOCarticle#1#2#3{\vskip5.2pt
\setbox0=\hbox{#1\hskip18pt{\it#2}}
\ifdim\wd0<28pc
   %% The simple case, it will fit on one line:
  \hbox to30pc{\strut#1\dotfill{\it#2}\hbox to24pt{\hss#3}}
\else
   %% Find out what we must do next:
   \setbox1=\hbox{#1} \setbox2=\hbox{\hskip18pt{\it #2}}
   \dimen3=\wd1
   \advance\dimen3 by \wd2
   %% Is it 2 lines long?
  \ifdim\dimen3<56pc
   %% Yes, it is 2 lines long.
   %% Is title more than one line long?
       \ifdim\wd1>28pc
   %% Title is more than 1 line long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=24pt
   #1% 
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 1 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=24pt
   #1\dotfill\break\hbox to28pc{\dotfill\strut\hbox{{\it#2}\hbox 
   to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \else
   %% It is more than 2 lines long!
   %% Is title more than two lines long?
       \ifdim\wd1>56pc
   %% Title is more than 2 lines long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=24pt
   #1%
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 2 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=24pt
   #1\dotfill\break
      \hbox to28pc{\dotfill\strut\hbox{{\it#2}\hbox 
      to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \fi
\fi
\vskip5.2pt\hrule width 30pc}

\def\aster{*}
\newcount\linenumber
\def\findtitle#1 {\def\one{#1}%
\ifx\one\aster\let\xgo\relax\else\global\advance\linenumber by 1
\expandafter\gdef\csname line\the\linenumber\endcsname{#1}%
\let\xgo\findtitle\fi\xgo}


\def\makeissuetoc{\expandafter\ifx\csname line\the\linenumber\endcsname\relax
\let\ygo\relax\else\let\ygo\makeissuetoc
\hbox to30pc{\hfill\issuetocfont 
\expandafter\csname line\the\linenumber\endcsname\hfill}
\vskip8pt\fi\global\advance\linenumber by1\relax\ygo}

\def\issuetoc{\thispagestyle{empty}
\expandafter\findtitle\thisjourname{} *
\linenumber=1
\bgroup
\hyphenpenalty=10000
\def\\ {\hfill\break}
\makeissuetoc
\vskip24pt
\TOCvolumeline{Volume \currvolnumber, No.~\currissuenumber, \currissuemonth 
\ \currvolyear}}
\def\endissuetoc{\egroup\newpage}


From amyh@ai.mit.edu Tue Aug 10 14:12:52 1993
Return-Path: <amyh@ai.mit.edu>
Received: from life.ai.mit.edu by world.std.com (5.65c/Spike-2.0)
	id AA29372; Tue, 10 Aug 1993 14:12:41 -0400
Received: from rice-chex (rice-chex.ai.mit.edu) by life.ai.mit.edu (4.1/AI-4.10) for prod@world.std.com id AA24841; Tue, 10 Aug 93 14:12:44 EDT
From: amyh@ai.mit.edu (Amy Hendrickson)
Received: by rice-chex (4.1/AI-4.10) id AA15878; Tue, 10 Aug 93 14:12:42 EDT
Date: Tue, 10 Aug 93 14:12:42 EDT
Message-Id: <9308101812.AA15878@rice-chex>
To: prod@world.std.com
In-Reply-To: Suzanne M Rumsey's message of Fri, 6 Aug 1993 11:46:56 -0400 <199308061546.AA29671@world.std.com>
Subject: smjrnl.sty
Status: RO

%% August 10, 1993

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Style File for `Small Format Journals'                               %%
%% Kluwer Academic Publishers                                           %%
%%                                                                      %%
%% Prepared by Amy Hendrickson, TeXnology Inc.                          %%
%% (617) 738-8029,  net address: amyh@ai.mit.edu                        %%
%%                                                                      %%
%% Inquiries to Suzanne M. Rumsey, net address: prod@world.std.com      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{Document Style `Small Format Journals' 
for Kluwer Academic Publishers}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{Written by Amy Hendrickson, TeXnology, Inc.\space}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{Authors! Before beginning to work, please ftp the README file from}
\typeout{the directory /Kluwer/styles/journals at world.std.com}
\typeout{to see if you have the current version of this file!}
\typeout{This version is dated August 10, 1993}
\typeout{\space\space\space\space\space\space\space\space\space}
\typeout{\space\space\space\space\space\space\space\space\space}


%% Special Purpose Fonts
\font\smallcaps=cmcsc10 scaled 700
\font\medcaps=cmcsc10 scaled 750 %
\def\bigbit{\Large\it}

\def\issuetocfont{\LARGE\bf}
\let\bit\sl
\let\sectionfont\bf
\let\subsubsectionfont\it

%%%%%%%
%% Variations on  LaTeX book.sty 


\def\@ptsize{0}               % Default is REP10.STY
\@namedef{ds@11pt}{\def\@ptsize{1}} % 11pt option reads in REP11.STY
\@namedef{ds@12pt}{\def\@ptsize{2}} % 12pt option reads in REP12.STY


\@twosidetrue     %  Defines twoside option.
\@mparswitchtrue  %  Marginpars go on outside of page.

\def\ds@draft{\overfullrule 5pt}  % Causes overfull hboxes to be marked.

\@options

%%%%%% Start Bk10.sty
% bk10.sty 19-Jan-88

\lineskip 1pt \normallineskip 1pt
\def\baselinestretch{1}

\def\@normalsize{\@setsize\normalsize{12pt}\xpt\@xpt
\abovedisplayskip 10pt plus2pt minus5pt\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus3pt\belowdisplayshortskip 6pt plus3pt
minus3pt\let\@listi\@listI} 
\def\small{\@setsize\small{11pt}\ixpt\@ixpt
\abovedisplayskip 8.5pt plus 3pt minus 4pt\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus2pt\belowdisplayshortskip 4pt plus2pt minus 2pt
\def\@listi{\leftmargin\leftmargini \topsep 4pt plus 2pt minus 2pt\parsep 2pt
plus 1pt minus 1pt
\itemsep \parsep}}

\def\footnotesize{\@setsize\footnotesize{9.5pt}\viiipt\@viiipt
\abovedisplayskip 6pt plus 2pt minus 4pt\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus 1pt\belowdisplayshortskip 3pt plus 1pt minus
2pt
\def\@listi{\leftmargin\leftmargini \topsep 3pt plus 1pt minus 1pt\parsep 2pt
plus 1pt minus 1pt
\itemsep \parsep}}
\def\scriptsize{\@setsize\scriptsize{8pt}\viipt\@viipt}
\def\tiny{\@setsize\tiny{6pt}\vpt\@vpt}
\def\large{\@setsize\large{14pt}\xiipt\@xiipt}
\def\Large{\@setsize\Large{18pt}\xivpt\@xivpt}
\def\LARGE{\@setsize\LARGE{22pt}\xviipt\@xviipt}
\def\huge{\@setsize\huge{25pt}\xxpt\@xxpt}
\def\Huge{\@setsize\Huge{30pt}\xxvpt\@xxvpt}
\normalsize 

\oddsidemargin 1in \evensidemargin 1in 
\marginparwidth .75in \marginparsep 7pt 
 \topmargin .75in \headheight 12pt \headsep 24pt \footskip .35in 

\raggedbottom
\textheight = 44.5pc
\textwidth 30pc 

\columnsep 10pt \columnseprule 0pt 

\footnotesep 6.65pt 
\skip\footins 9pt plus 4pt minus 2pt 
\floatsep 12pt plus 2pt minus 2pt \textfloatsep 20pt plus 2pt minus 4pt
\intextsep 12pt plus 2pt minus 2pt \@maxsep 20pt \dblfloatsep 12pt plus 2pt
minus 2pt \dbltextfloatsep 20pt plus 2pt minus 4pt \@dblmaxsep 20pt 
\@fptop 0pt plus 1fil \@fpsep 8pt plus 2fil \@fpbot 0pt plus 1fil 
\@dblfptop 0pt plus 1fil \@dblfpsep 8pt plus 2fil \@dblfpbot 0pt plus 1fil
\marginparpush 5pt 

\parskip 0pt plus 1pt \parindent 8pt \partopsep 2pt plus 1pt minus 1pt 
\@lowpenalty 51 \@medpenalty 151 \@highpenalty 301 
\@beginparpenalty -\@lowpenalty \@endparpenalty -\@lowpenalty \@itempenalty
-\@lowpenalty 

\clubpenalty=10000
\widowpenalty=10000



%% Article commands:

\def\authorrunninghead#1{\def\theauthors{\uppercase{#1}}}
\def\titlerunninghead#1{\def\thetitle{\uppercase{#1}}}

\def\thetitle{THE TITLE???}
\def\theauthors{}

\newif\iftechnote
\def\technicalnote{\global\technotetrue}


\newif\iftitle
\def\title#1{\global\appendonfalse
\refstepcounter{chapter}
\c@section=0
\c@subsection=0
\c@subsubsection=0
\c@footnote=0
\c@equation=0
\c@figure=0
\c@table=0
\vspace*{24pt}
\iftechnote\global\technotefalse
\noindent {\bigbit Technical Note}\vskip4pt\fi
\global\titletrue
{\def\\ {\hfill\break}%
\Large\raggedright\hyphenpenalty=10000\noindent\bf#1\vskip12pt}}
\let\articletitle\title


\def\xemail{\email}

\long\def\author#1#2{\def\two{#2}\ifx\two\xemail\long\def\go{\emailauthor{#1}}
\else\long\def\go{\noemailauthor{#1}#2}\fi\go}

\def\emailauthor#1#2{\ifdim\lastskip=4pt \vskip-6pt\fi\setbox0=\hbox{%
\smallcaps\uppercase{#1}\qquad\smallcaps\lowercase{#2}}
\ifdim\wd0<30pc
\hbox to30pc{\smallcaps\uppercase{#1}\hfill
\smallcaps\lowercase{#2}}
\else
\noindent{\smallcaps\uppercase{#1}}
\vskip4pt
\setbox1=\hbox{\smallcaps\lowercase{#2}}
\ifdim\wd1>30pc\message{EMAIL ADDRESS TOO WIDE! PLEASE LIST
SEPARATELY!}
! EMAIL ADDRESS TOO WIDE! PLEASE LIST SEPARATELY !

#2
\else\hbox to30pc{\hfill\smallcaps\lowercase{#2}}\fi\fi
\vskip4pt}

\def\noemailauthor#1{\noindent{\smallcaps\uppercase{#1}}
\vskip4pt}


\let\authors\author

\def\affil#1{\vskip-4pt{\def\\ {\hfill\break}
\footnotesize\it\noindent#1\vskip8pt}}

\def\editor#1{\vskip4pt
{\footnotesize\noindent{\bf Editor:} #1\vskip1sp}}

\def\abstract#1{\vskip14pt
{\footnotesize\noindent{\bf Abstract.} #1\vskip1sp}}

\def\keywords#1{\vskip8pt
{\footnotesize\noindent{\bf Keywords:} #1\vskip1sp}}


\def\issuenumber#1{\def\currissuenumber{#1}}
\def\issuemonth#1{\def\currissuemonth{#1}}
\def\volnumber#1{\def\currvolnumber{#1}}
\def\volyear#1{\def\currvolyear{#1}}
\def\journame#1{\def\thisjourname{#1}}

\volnumber{[Volumn Number]}
\volyear{[Volumn Year]}
\issuenumber{[Issue Number]}
\issuemonth{[Issue Year]}
\journame{[Journal Name]}

\newcount\articlenumber

\def\article{\clearpage
\ifodd\c@page\else\null\clearpage\fi
}

\def\endarticle{\write\@auxout{\string\expandafter
\string\gdef\string\csname\space 
endpage\the\articlenumber\endcsname{\the\c@page}}
\newpage
\authorrunninghead{}
}

\def\kluwerline{\global\advance\articlenumber by1
\hbox to30pc{\hfill\egtrm \thisjourname,
\currvolnumber, \the\c@page--%
\expandafter\ifx\csname endpage\the\articlenumber\endcsname\relax%
??\else\csname endpage\the\articlenumber\endcsname\fi\ (\currvolyear)}
\vskip2pt
\hbox to30pc{\hfill\egtrm \raise1.5pt\hbox{\scriptsize\copyright}%
\ \currvolyear\ %
Kluwer Academic Publishers, Boston. Manufactured in The Netherlands.}
\vskip3pt
}

\newcount\footnum
\newcount\savefootnum
\def\notes{\ifnum\footnum=0\else
\section*{Notes}
\savefootnum=\footnum
\footnum=0
\noindent\loop\ifnum\savefootnum>\footnum
\global\advance\footnum by1
\csname foot\the\footnum\endcsname
\expandafter\gdef\csname foot\the\footnum\endcsname{\relax}
\repeat\global\footnum=0\relax\fi}


\def\footnote#1{\global\advance\footnum by 1\relax$^{\the\footnum}$%
\long\expandafter\gdef\csname foot\the\footnum\endcsname{%
\vtop{\footnotesize\hsize=30pc\leftskip=12pt\relax\parindent=-12pt
\indent\hbox to12pt{\hfill\the\footnum. }{#1\strut\vskip1sp}}\vskip1pt}}

%% End Matter
\def\acknowledgements{\goodbreak\section*{Acknowledgements}}

\def\thebibliography#1{\notes\section*{References}%
\bgroup\footnotesize\labelsep=6pt
\list{[\arabic{enumi}]}{\settowidth\labelwidth{[#1]}\leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \usecounter{enumi}}
    \def\newblock{\hskip .11em plus .33em minus .07em}
    \sloppy\clubpenalty4000\widowpenalty4000
    \sfcode`\.=1000\relax}

\def\endthebibliography{\endlist\egroup\vskip\baselineskip\relax}

\def\references{\goodbreak\section*{References}
\bgroup\footnotesize\labelsep=6pt
\list{[\arabic{enumi}]}{\settowidth\labelwidth{[99]}\leftmargin\labelwidth
 \advance\leftmargin\labelsep
 \usecounter{enumi}}
 \def\newblock{\hskip .11em plus .33em minus .07em}
 \sloppy\clubpenalty4000\widowpenalty4000
 \sfcode`\.=1000\relax\frenchspacing}

\def\endreferences{\endlist\egroup\vskip\baselineskip\relax}

%% Alphabetical References
\def\alphareferences{\notes\goodbreak
\section*{References}
\bgroup\let\bibitem\alphabibitem\footnotesize \leftskip=6pt
\parindent=-6pt \indent\hskip-6pt\relax\ignorespaces}
\def\endalphareferences{\vskip1sp\egroup}

\def\alphabibitem{\@ifnextchar[{\alpha@lbibitem}{\alpha@bibitem}}

\def\alpha@lbibitem[#1]#2{\vskip1sp%\item[\@biblabel{#1}]
\if@filesw 
      { \def\protect##1{\string ##1\space}\immediate
        \write\@auxout{\string\bibcite{#2}{#1}}}\fi\ignorespaces}
%% Placement of `}' in def of \@lbibitem corrected 29 Apr 87
%% (Error found by Arthur Ogawa.)

\def\alpha@bibitem#1{\vskip1sp%\item
\if@filesw \immediate\write\@auxout
       {\string\bibcite{#1}{#1}}\fi\ignorespaces}


\newif\ifappendon

\def\appendix{\goodbreak
\global\appendontrue
\c@section=0
\c@subsection=0
\c@subsubsection=0
\c@equation=0
\c@figure=0
\c@table=0
\section*{Appendix}}

% \@startsection {NAME}{LEVEL}{INDENT}{BEFORESKIP}{AFTERSKIP}{STYLE} 
%            optional * [ALTHEADING]{HEADING}
%    Generic command to start a section.  
%    NAME       : e.g., 'subsection'
%    LEVEL      : a number, denoting depth of section -- e.g., chapter=1,
%                 section = 2, etc.  A section number will be printed if
%                 and only if LEVEL < or = the value of the secnumdepth
%                 counter.
%    INDENT     : Indentation of heading from left margin
%    BEFORESKIP : Absolute value = skip to leave above the heading.  
%                 If negative, then paragraph indent of text following 
%                 heading is suppressed.
%    AFTERSKIP  : if positive, then skip to leave below heading,
%                       else - skip to leave to right of run-in heading.
%    STYLE      : commands to set style
%  If '*' missing, then increments the counter.  If it is present, then
%  there should be no [ALTHEADING] argument.  A sectioning command
%  is normally defined to \@startsection + its first six arguments.

\def\section{\@startsection {section}{1}{\z@}{-20pt plus -2pt minus 
 -1pt}{12pt plus 1pt}{\normalsize\sectionfont}}
\def\subsection{\@startsection{subsection}{2}{\z@}{-20pt plus -2pt
minus -1pt}{12pt plus 1pt}{\normalsize\bit}}
\def\subsubsection{\@startsection{subsubsection}{3}{\z@}{-20pt
plus -2pt minus -1pt}{12pt plus1pt}{\normalsize\subsubsectionfont}}


\setcounter{secnumdepth}{3}

\leftmargini 16pt %24pt
\leftmarginii 18pt % 22pt 
\leftmarginiii 18pt %18.7pt 
\leftmarginiv 16pt %
\leftmarginv 10pt
\leftmarginvi 10pt
\leftmargin\leftmargini
\labelsep 6pt

\labelwidth\leftmargini\advance\labelwidth-\labelsep
\def\@listI{\leftmargin\leftmargini \parsep 4pt plus 2pt minus 1pt\topsep 8pt
plus 2pt minus 4pt\itemsep 4pt plus 2pt minus 1pt}
\let\@listi\@listI
\@listi 
\def\@listii{\leftmargin\leftmarginii
 \labelwidth\leftmarginii\advance\labelwidth-\labelsep
 \topsep 4pt plus 2pt minus 1pt
 \parsep 2pt plus 1pt minus 1pt
 \itemsep \parsep}
\def\@listiii{\leftmargin\leftmarginiii
 \labelwidth\leftmarginiii\advance\labelwidth-\labelsep
 \topsep 2pt plus 1pt minus 1pt 
 \parsep \z@ \partopsep 1pt plus 0pt minus 1pt
 \itemsep \topsep}
\def\@listiv{\leftmargin\leftmarginiv
 \labelwidth\leftmarginiv\advance\labelwidth-\labelsep}
\def\@listv{\leftmargin\leftmarginv
 \labelwidth\leftmarginv\advance\labelwidth-\labelsep}
\def\@listvi{\leftmargin\leftmarginvi
 \labelwidth\leftmarginvi\advance\labelwidth-\labelsep}

%%%%% End of Bk10.sty

\def\labelenumi{\theenumi.}    
\def\theenumi{\arabic{enumi}}     
 
\def\labelenumii{(\theenumii)}
\def\theenumii{\Alph{enumii}}
\def\p@enumii{\theenumi}

\def\labelenumiii{\theenumiii.}
\def\theenumiii{\hskip5pt\hbox to5pt{\hss\roman{enumiii}}}
\def\p@enumiii{\theenumi(\theenumii)}

\def\labelenumiv{\theenumiv.}
\def\theenumiv{\Alph{enumiv}}     
\def\p@enumiv{\p@enumiii\theenumiii}

\def\labelitemi{$\bullet$}
\def\labelitemii{\bf --}
\def\labelitemiii{$\ast$}
\def\labelitemiv{$\cdot$}

\def\verse{\let\\=\@centercr  
  \list{}{\itemsep\z@ \itemindent -1.5em\listparindent \itemindent 
          \rightmargin\leftmargin\advance\leftmargin 1.5em}\item[]}
\let\endverse\endlist

\def\quotation{\list{}{\listparindent 1.5em
    \itemindent\listparindent
    \rightmargin\leftmargin\parsep 0pt plus 1pt}\item[]}
\let\endquotation=\endlist

\def\quote{\list{}{\rightmargin\leftmargin}\item[]}
\let\endquote=\endlist

\def\descriptionlabel#1{\hspace\labelsep \bf #1}
\def\description{\list{}{\labelwidth\z@ \itemindent-\leftmargin
       \let\makelabel\descriptionlabel}}

\let\enddescription\endlist

\newdimen\descriptionmargin
\descriptionmargin=3em

\arraycolsep 5pt   % Half the space between columns in an array environment.
\tabcolsep 6pt     % Half the space between columns in a tabular environment.
\arrayrulewidth .4pt % Width of rules in array and tabular environment.
\doublerulesep 2pt   % Space between adjacent rules in array or tabular env.

\tabbingsep \labelsep   % Space used by the \' command.  (See LaTeX manual.)

\skip\@mpfootins = \skip\footins

\fboxsep = 3pt    % Space left between box and text by \fbox and \framebox.
\fboxrule = .4pt  % Width of rules in box made by \fbox and \framebox.

\newcounter{part}
\newcounter {chapter}
\newcounter {section}[chapter]
\newcounter {subsection}[section]
\newcounter {subsubsection}[subsection]

\def\@sect#1#2#3#4#5#6[#7]#8{\ifnum #2>\c@secnumdepth
     \def\@svsec{}\else 
     \refstepcounter{#1}\edef\@svsec{\csname the#1\endcsname.%<=== new, 7/1/93
\hskip 1em }\fi
     \@tempskipa #5\relax
      \ifdim \@tempskipa>\z@ 
        \begingroup #6\relax
          \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M #8\par}%
        \endgroup
       \csname #1mark\endcsname{#7}\addcontentsline
         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                      \protect\numberline{\csname the#1\endcsname}\fi
                    #7}\else
        \def\@svsechd{#6\hskip #3\@svsec #8\csname #1mark\endcsname
                      {#7}\addcontentsline
                           {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                             \protect\numberline{\csname the#1\endcsname}\fi
                       #7}}\fi
     \@xsect{#5}}


\def\thepart          {\Roman{part}}
\def\thechapter       {}
\def\thesection       {\ifappendon A.\fi\arabic{section}}
\def\thesubsection    {\thesection.\arabic{subsection}}
\def\thesubsubsection {\thesubsection.\arabic{subsubsection}}

\def\@pnumwidth{1.55em}
\def\@tocrmarg {2.55em}
\def\@dotsep{4.5}
\setcounter{tocdepth}{2}


\long\def\@makefntext#1{\parindent 1em\noindent 
            \hbox to 1.8em{\hss$^{\@thefnmark}$}#1}

%  \c@topnumber            : Number of floats allowed at the top of a column.
%  \topfraction            : Fraction of column that can be devoted to floats.
%  \c@dbltopnumber, \dbltopfraction : Same as above, but for double-column
%                          floats.
%  \c@bottomnumber, \bottomfraction : Same as above for bottom of page.
%  \c@totalnumber          : Number of floats allowed in a single column, 
%                          including in-text floats.
%  \textfraction         : Minimum fraction of column that must contain text.
%  \floatpagefraction    : Minimum fraction of page that must be taken
%                          up by float page.

%% June 10, 1993, reset these to more generous values to make it easier
%% to position floats.

\setcounter{topnumber}{3}
\setcounter{bottomnumber}{3}

\def\topfraction{.99}
\def\bottomfraction{.9}
\def\textfraction{.01}
\def\floatpagefraction{.5}

\setcounter{totalnumber}{9}

\setcounter{dbltopnumber}{2}
\def\dbltopfraction{.7}
\def\dblfloatpagefraction{.5}

\newcounter{figure}[chapter]
\def\thefigure{\@arabic\c@figure}

\def\fps@figure{tbp}
\def\ftype@figure{1}
\def\ext@figure{lof}
\def\fnum@figure{Figure\ \ifappendon A\fi\thefigure\theletter}
\def\figure{\@float{figure}}
\let\endfigure\end@float
\def\endfigure{\end@float\gdef\@currentlabel{}}
\@namedef{figure*}{\@dblfloat{figure}}
\@namedef{endfigure*}{\end@dblfloat}

\newcounter{table}[chapter]
\def\thetable{\@arabic\c@table}

\def\fps@table{tbp}
\def\ftype@table{2}
\def\ext@table{lot}
\def\fnum@table{Table \ifappendon A\fi\thetable\theletter}
\def\table{\footnotesize\@float{table}}
\let\endtable\end@float
\@namedef{table*}{\@dblfloat{table}}
\@namedef{endtable*}{\end@dblfloat}

\mark{{}{}}   % Initializes TeX's marks

\def\ps@headings{\def\@oddfoot{}\def\@evenfoot{}%       No feet.
\def\@evenhead{{\elvrm\thepage}\hfil\medcaps\theauthors}% 
                                                %       Left heading.
\def\@oddhead{\hbox{}\iftitle\global\titlefalse
\vbox to0pt{\vss\kluwerline}\else
{\medcaps\thetitle}\hfil{\elvrm\thepage}\fi}% Right heading.
}

\@addtoreset{equation}{chapter}   % Makes \chapter reset 'equation' counter.



\newif\ifqedequation
\def\theequation{\ifappendon A.\fi\arabic{equation}%
\ifinmathqed\global\inmathqedfalse\global\qedequationtrue\fi}

\ps@headings                % `headings' page style
\pagenumbering{arabic}      % Arabic page numbers
\onecolumn                  % Single-column.

%%%%%%%%%%%%
%%% Math

\def\themathletter{\relax}

\def\mathletter#1{\gdef\themathletter{#1}}
\def\spletter#1{\gdef\thespletter{#1}}
\spletter{}

%% Use: 
% \begin{equation} or \[  
% \begin{splitmath} top line\\ 
%                 bottom line
% \end{splitmath}
% \end{equation} or \]  

\def\splitmath#1\\{\hbox to-\mathindent{}\vcenter\bgroup%
\ifequation\advance\hsize by-24pt\relax\fi
\hbox to\hsize{%
$\displaystyle #1$\hss}\vskip2pt
\global\setbox0=\hbox\bgroup$\displaystyle}

\def\endsplitmath{$\egroup\hbox to\hsize{\hss\unhbox0}\egroup}

\newif\ifinmathqed
\newif\ifqedequation

\def\theequation{\thespletter\ifappendon A.\fi\arabic{equation}\themathletter}

%%% Variation on Fleqn.sty
% fleqn.sty 24-May-89

\linewidth=30pc

\def\[{\relax\ifmmode\@badmath\else\bgroup\@beginparpenalty\predisplaypenalty
 \@endparpenalty\postdisplaypenalty
 \begin{trivlist}
\vskip\abovedisplayskip
\item[]\leavevmode
 \hbox to\linewidth\bgroup$ \displaystyle
 \hskip\mathindent\bgroup\fi}

\def\]{\relax\ifmmode \egroup $\hfil%
\ifinmathqed\vrule height 6pt width6pt depth0pt\relax\fi%
\egroup 
\ifinmathqed\else\vskip\belowdisplayskip\fi
\end{trivlist}
\egroup\else
\@badmath \fi\spletter{}\mathletter{}}

\def\xrelax{\relax}


\newif\iffirsttime
\global\firsttimetrue
\newif\ifequation
\def\equation{\global\equationtrue\@beginparpenalty\predisplaypenalty%
\@endparpenalty\postdisplaypenalty%
\trivlist%
\vskip\abovedisplayskip%
\item[]\leavevmode%
\setbox0=\hbox\bgroup $ \displaystyle%
\hskip\mathindent}

\def\endequation{$\egroup%
\ifx\themathletter\xrelax\global\firsttimetrue%
\refstepcounter{equation}\else%
\iffirsttime\global\firsttimefalse\refstepcounter{equation}\fi\fi%
\setbox1=\hbox{\copy0\@eqnnum}%
\ifdim\wd1>\linewidth%
\vbox{\unskip\noindent\hbox to\linewidth{\unhbox0\hss}\vskip3pt%
\noindent\hbox to\linewidth{\hfill\displaywidth\linewidth\llap{\@eqnnum}}}%
\else%
\vbox{\unskip\noindent\hbox to\linewidth{%
\unhbox0\hfil\displaywidth\linewidth\llap{\@eqnnum}}}%
\fi%
\gdef\themathletter{\relax}\spletter{}%
\ifinmathqed\global\inmathqedfalse\global\qedequationtrue\fi%
\vskip\belowdisplayskip%
\endtrivlist\def\themathletter{\relax}\global\equationfalse}

\def\@@eqncr{\let\@tempa\relax 
    \ifcase\@eqcnt \def\@tempa{& & &}\or \def\@tempa{& &} 
      \else \def\@tempa{&}\fi 
     \@tempa 
\ifx\themathletter\xrelax
%% Aug. 9 bug fix ==>
\if@eqnsw
\stepcounter{equation}\fi
%% <==
\else\iffirsttime\global\firsttimefalse\stepcounter{equation}
\fi\fi
\if@eqnsw\@eqnnum
\fi\global\@eqnswtrue\global\@eqcnt\z@\cr}



\def\eqnarray{\let\@currentlabel=\theequation
\global\@eqnswtrue
\global\@eqcnt\z@\tabskip\mathindent\let\\=\@eqncr
\abovedisplayskip\topsep\ifvmode\advance\abovedisplayskip\partopsep\fi
\belowdisplayskip\abovedisplayskip
\belowdisplayshortskip\abovedisplayskip
\abovedisplayshortskip\abovedisplayskip
$$\everycr={\noalign{\gdef\themathletter{\relax}}}
\halign to
\linewidth\bgroup\@eqnsel\hskip\@centering$\displaystyle\tabskip\z@
 {##}$&\global\@eqcnt\@ne 
\hskip 2\arraycolsep \hfil${##}$\hfil
 &\global\@eqcnt\tw@ 
\hskip 2\arraycolsep $\displaystyle{##}$\hfil 
 \tabskip\@centering&\llap{##}\tabskip\z@\cr}

\def\endeqnarray{\@@eqncr\egroup
\global\firsttimetrue\spletter{}
$$\global\@ignoretrue }

\newdimen\mathindent 
\mathindent = 24pt

\def\wideequation{\bgroup\mathindent=0pt}
\def\endwideequation{\egroup\mathindent=24pt}

%%% End Math

%%% Captions

\def\theletter{\relax}
\newif\ifxfirsttime
\xfirsttimetrue

\def\caption{\ifx\@captype\xtable\else
\ifx\theletter\xrelax
\global\xfirsttimetrue\refstepcounter\@captype\else
\ifxfirsttime\global\xfirsttimefalse\refstepcounter\@captype\fi\fi
\fi
\edef\@currentlabel{\expandafter\csname p@\@captype\endcsname%
\expandafter\csname the\@captype\endcsname\theletter}
\xdef\currcaptype{\@captype}
\@dblarg{\@caption\@captype}}


\def\letteredcaption#1{\gdef\theletter{#1}\caption}

\long\def\@makecaption#1#2{%
 \ifx\@captype\xtable
\vskip1pt\else\vskip18pt\fi
%
\noindent\footnotesize{\it #1.} #2\par     %   THEN set as ordinary paragraph.
%
\xdef\@currentlabel{\expandafter\csname p@\@captype\endcsname%
\expandafter\csname the\@captype\endcsname\theletter}
%
\gdef\theletter{\relax}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Table Macros


\long\def\@caption#1[#2]#3{\par
\begingroup
    \@parboxrestore
    \normalsize
    \@makecaption{\csname fnum@#1\endcsname}{\ignorespaces #3}\par
  \endgroup}

\def\catchlabel{}
\let\savelabel\label

\def\table{\def\label##1{\gdef\catchlabel{##1}}%
\def\caption##1{\gdef\catchcaption{##1}}%
\footnotesize\@float{table}}

\let\saveendtable\endtable

\def\endtable{\ifx\catchlabel\empty\else
\savelabel{\catchlabel}\fi%
\gdef\@currentlabel{}%
\gdef\catchlabel{}\saveendtable}

\let\savecaption\caption
\newbox\savecurrtable
\let\savetabular\tabular
\let\saveendtabular\endtabular

\def\tabular{\global\setbox\savecurrtable\hbox\bgroup\savetabular}

\def\endtabular{\saveendtabular\egroup
\ifx\theletter\xrelax
\global\xfirsttimetrue\refstepcounter\@captype\else
\ifxfirsttime\global\xfirsttimefalse\refstepcounter\@captype\fi\fi
\hbox to30pc{\hss\vtop{\hsize=\wd\savecurrtable
\ifx\catchcaption\empty\else\savecaption{\catchcaption
\xdef\@currentlabel{\thetable\theletter}}\fi
\vskip1pt
\unhbox\savecurrtable}\hss}
\gdef\catchcaption{}}

%% for \begin{tabular*}...\end{tabular*}
\expandafter \let \csname endtabular*\endcsname = \endtabular
\expandafter \def\csname tabular*\endcsname #1{%
\global\setbox\savecurrtable\hbox\bgroup\def\@halignto{to #1}\@tabular}

\def\xtable{table}


\def\@array[#1]#2{\setbox\@arstrutbox=\hbox{\vrule 
     height\arraystretch \ht\strutbox
     depth\arraystretch \dp\strutbox
     width\z@}\@mkpream{#2}\edef\@preamble{\halign \noexpand\@halignto
\bgroup%
\tabskip\z@\@arstrut\@preamble
\ifx\@captype\xtable\hskip-\tabcolsep\fi%% <==== Changed
\tabskip\z@ \cr}%
\let\@startpbox\@@startpbox \let\@endpbox\@@endpbox%
  \if #1t\vtop \else \if#1b\vbox \else \vcenter \fi\fi%
  \bgroup\let\par\relax%
  \let\@sharp##\let\protect\relax \lineskip\z@\baselineskip\z@\@preamble}

%% new
\def\new@tabacol{\edef\@preamble{\@preamble\hskip0pt}}

\def\@tabclassz{\ifcase \@lastchclass\@acolampacol% 
\or \@ampacol \or
   \or \or \@addamp \or \@acolampacol\or \@firstampfalse 
\ifx\@captype\xtable \new@tabacol\else\@tabacol \fi%
\fi%
\edef\@preamble{\@preamble%
  \ifcase \@chnum%
     \hfil\ignorespaces\@sharp\unskip\hfil%
     \or \ignorespaces\@sharp\unskip\hfil%
     \or \hfil\hskip\z@ \ignorespaces\@sharp\unskip\fi}}

\let\savehline\hline
\def\hline{\noalign{\vskip3pt}\savehline\noalign{\vskip3pt}}


%% Listing

\def\enumerate{\ifnum \@enumdepth >3 \@toodeep\else
      \advance\@enumdepth \@ne 
      \edef\@enumctr{enum\romannumeral\the\@enumdepth}\list
      {\csname label\@enumctr\endcsname}{\usecounter
        {\@enumctr}\def\makelabel##1{##1\hss}}\fi}

\def\itemize{\ifnum \@itemdepth >3 \@toodeep\else \advance\@itemdepth \@ne
\edef\@itemitem{labelitem\romannumeral\the\@itemdepth}%
\list{\csname\@itemitem\endcsname}%{\def\makelabel##1{\hss\llap{##1}}}\fi}
{\def\makelabel##1{##1\hss}}\fi}


\def\@trivlist{\ifnum\@itemdepth>1 \vskip-\topsep\fi
\@topsepadd\topsep
  \if@noskipsec \leavevmode \fi
  \ifvmode \advance\@topsepadd\partopsep \else \unskip\par\fi
  \if@inlabel \@noparitemtrue \@noparlisttrue 
    \else \@noparlistfalse \@topsep\@topsepadd \fi
    \advance\@topsep \parskip
  \leftskip\z@
%\advance \leftskip1pc % <<<<<<<<<
\rightskip\@rightskip \parfillskip\@flushglue
  \@setpar{\if@newlist\else{\@@par}\fi}%
  \global\@newlisttrue \@outerparskip\parskip}

%%%%%%%%%%% Code examples in text

%% Algorithm

\newcount\algocount
\def\looker{\ifx\next\end\else\ifx\next\lineending\vskip-4pt%
\noindent\qquad\else\global\advance\algocount by1\relax%
\vskip0pt\noindent\hskip12pt\hbox to0pt{\hss\the\algocount.}\quad\fi\fi}

\def\lineending{\parfillskip=0pt plus1fil\relax\futurelet\next\looker}

{\obeylines
\gdef\algorithm{\medskip\let\bit\bf
\def\note##1{\parfillskip=0pt\hfill##1}\def\ {\qquad}%
\baselineskip=12pt\parskip=2pt\obeylines\let^^M=\lineending}}

\def\endalgorithm{\vskip1pt}

%% Theorems, Proofs, Examples, etc.

\def\@endtheorem{\if@newlist\@noitemerr\fi 
   \if@inlabel\indent\fi 
   \ifhmode\unskip \par\fi 
\vskip6pt}

\def\@thmcountersep{}



\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{claim}{Claim}[chapter]

\def\demo#1{\vskip12pt
\noindent{\it#1.\/} }
\def\enddemo{\vskip12pt}

\def\example{\vskip12pt
\noindent{\it Example:\/} }
\def\endexample{\qed
\vskip12pt}

\def\inmathqed{\global\inmathqedtrue}

\def\qed{\penalty-250%
\hbox to 6pt{\hfill}\hfill\llap{%
\vbox{\hrule\hbox{\vrule height6pt\hskip6pt\vrule}\hrule}}}


\def\slug{\penalty-250%
\hbox to 6pt{\hfill}\hfill\llap{\vrule height 6pt width 6pt depth0pt}}

\def\proof{\futurelet\next\lookforbracket}

\def\lookforbracket{\ifx\next[\let\go\usespecialterm
\else\let\go\relax
\vskip1sp\noindent{\bf Proof:}\enskip\relax\ignorespaces\fi\go}

\def\usespecialterm[#1]{\vskip12pt
\noindent{\bf #1:}\enskip\relax\ignorespaces}

\def\endproof{\ifqedequation\vskip-6pt%
\vskip-\belowdisplayskip\hfill\slug\else%
\ifinmathqed\global\inmathqedfalse\else\slug\fi\fi\vskip12pt}

\def\proclaim#1{\vskip12pt\bgroup\noindent{\bf#1}\enskip\it\ignorespaces}
\def\endproclaim{\egroup\vskip6pt}

%%% Macros for Kluwer: Issue and Volume Table of Contents

\def\volumetocline{\hbox to30pc{\hss\Large\bf Table of Contents:
Volume \currvolnumber\ (\currvolyear)\hss}}

\def\volumetoc{\clearpage\thispagestyle{empty}\bgroup
\hyphenpenalty=10000
\let\TOCarticle\volTOCarticle
\def\\ {\hfill\break}
\volumetocline}

\def\endvolumetoc{\egroup\newpage}

\def\tocnumberline#1{\vskip26pt
{\elvbf\noindent#1}\vskip8pt}

\def\TOCvolumeline#1{\noindent{\large#1}\vskip24pt
\hrule width 30pc}

%% Changed to accept titles more than 2 lines long


\def\volTOCarticle#1#2#3{\vskip.5pt
\setbox0=\hbox{#1\hskip12pt{\it#2}}
\ifdim\wd0<27pc
   %% The simple case, it will fit on one line:
  \hbox to30pc{\strut#1\dotfill{\it#2}\hbox to36pt{\hss#3}}
\else
   %% Find out what we must do next:
   \setbox1=\hbox{#1} \setbox2=\hbox{\hskip18pt{\it #2}}
   \dimen3=\wd1
   \advance\dimen3 by \wd2
   %% Is it 2 lines long?
  \ifdim\dimen3<56pc
   %% Yes, it is 2 lines long.
   %% Is title more than one line long?
       \ifdim\wd1>28pc
   %% Title is more than 1 line long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=36pt
   #1% 
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 1 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=36pt
   #1\dotfill\break\hbox to27pc{\dotfill\strut\hbox{{\it#2}\hbox 
   to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \else
   %% It is more than 2 lines long!
   %% Is title more than two lines long?
       \ifdim\wd1>56pc
   %% Title is more than 2 lines long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=36pt
   #1%
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 2 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=36pt
   #1\dotfill\break
      \hbox to27pc{\dotfill\strut\hbox{{\it#2}\hbox 
      to0pt{\hskip36pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \fi
\fi
\vskip.5pt
}

%% Changed to cover possibility of title 2 or more lines long.

\def\TOCarticle#1#2#3{\vskip5.2pt
\setbox0=\hbox{#1\hskip18pt{\it#2}}
\ifdim\wd0<28pc
   %% The simple case, it will fit on one line:
  \hbox to30pc{\strut#1\dotfill{\it#2}\hbox to24pt{\hss#3}}
\else
   %% Find out what we must do next:
   \setbox1=\hbox{#1} \setbox2=\hbox{\hskip18pt{\it #2}}
   \dimen3=\wd1
   \advance\dimen3 by \wd2
   %% Is it 2 lines long?
  \ifdim\dimen3<56pc
   %% Yes, it is 2 lines long.
   %% Is title more than one line long?
       \ifdim\wd1>28pc
   %% Title is more than 1 line long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=24pt
   #1% 
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 1 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=24pt
   #1\dotfill\break\hbox to28pc{\dotfill\strut\hbox{{\it#2}\hbox 
   to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \else
   %% It is more than 2 lines long!
   %% Is title more than two lines long?
       \ifdim\wd1>56pc
   %% Title is more than 2 lines long:
   \parfillskip=0pt \parindent=0pt
   \rightskip=24pt
   #1%
   \dotfill\strut\hbox{{\it#2}\hbox to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}
       \else
   %% Title is not more than 2 line long:
   \parfillskip=0pt
   \parindent=0pt
   \rightskip=24pt
   #1\dotfill\break
      \hbox to28pc{\dotfill\strut\hbox{{\it#2}\hbox 
      to0pt{\hskip24pt\hbox to0pt{\hss#3}\hss}}}
       \fi
   \fi
\fi
\vskip5.2pt\hrule width 30pc}

\def\aster{*}
\newcount\linenumber
\def\findtitle#1 {\def\one{#1}%
\ifx\one\aster\let\xgo\relax\else\global\advance\linenumber by 1
\expandafter\gdef\csname line\the\linenumber\endcsname{#1}%
\let\xgo\findtitle\fi\xgo}


\def\makeissuetoc{\expandafter\ifx\csname line\the\linenumber\endcsname\relax
\let\ygo\relax\else\let\ygo\makeissuetoc
\hbox to30pc{\hfill\issuetocfont 
\expandafter\csname line\the\linenumber\endcsname\hfill}
\vskip8pt\fi\global\advance\linenumber by1\relax\ygo}

\def\issuetoc{\thispagestyle{empty}
\expandafter\findtitle\thisjourname{} *
\linenumber=1
\bgroup
\hyphenpenalty=10000
\def\\ {\hfill\break}
\makeissuetoc
\vskip24pt
\TOCvolumeline{Volume \currvolnumber, No.~\currissuenumber, \currissuemonth 
\ \currvolyear}}
\def\endissuetoc{\egroup\newpage}


